:root{
  --bg:#0f1318; --bg-soft:#151b23; --panel:#111821; --card:#141d27;
  --surface:#f7fafc; --text:#f2f6fc; --text-muted:#b9c4d1; --ink:#1f2937;
  --primary:#3b82f6; --primary-2:#2563eb; --accent:#22d3ee; --danger:#ff6b6b; --ok:#34d399;
  --border:rgba(255,255,255,.15); --shadow:0 10px 28px rgba(0,0,0,.35); --radius:16px;
}
*{box-sizing:border-box} html,body{height:100%}
body{margin:0;background:linear-gradient(180deg,#10151b 0%, #0e1620 100%);color:var(--text);font:14px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Arial}

/* Top nav */
.nav{height:58px;display:flex;align-items:center;justify-content:space-between;padding:0 16px;background:rgba(255,255,255,.06);border-bottom:1px solid var(--border);backdrop-filter:blur(8px)}
.brand{display:flex;align-items:center;gap:10px;font-weight:600}
.brand .dot{width:10px;height:10px;border-radius:50%;background:var(--accent);box-shadow:0 0 12px var(--accent)}
.nav-logo{height:56px;max-width:720px;object-fit:contain; background:#0f1a28; border:1px solid var(--border); border-radius:10px; padding:6px 12px;filter:drop-shadow(0 2px 4px rgba(0,0,0,.25))}
.searchbar{display:flex;gap:8px;align-items:center}
.searchbar input{width:220px;padding:10px 12px;border-radius:12px;border:1px solid var(--border);background:#0f1620;color:#fff;outline:none}
.btn{border:none;padding:10px 14px;border-radius:12px;cursor:pointer;color:#fff}
.btn.primary{background:linear-gradient(135deg,var(--primary),var(--primary-2))}
.btn.ghost{background:transparent;border:1px solid var(--border);color:#e6eefb}
.btn.sm{padding:6px 10px;border-radius:10px;background:#112031}

/* Stage & Map - Estilo Mapbox */
.stage{position:relative;height:calc(100vh - 58px);width:100%}
#map{
  position:absolute;
  top:12px; left:12px; bottom:86px; right:12px;
  border-radius:8px;
  border:none;
  box-shadow:0 0 0 1px rgba(0,0,0,.1), 0 2px 8px rgba(0,0,0,.15);
  overflow:hidden;
}

/* Filtros */
.pill.filters{position:absolute;top:24px;left:60px;right:28px;display:flex;flex-wrap:wrap;gap:8px 10px;background:rgba(255,255,255,.10);border:1px solid var(--border);border-radius:14px;padding:8px;box-shadow:var(--shadow);z-index:9999}
.pill.filters select{flex:1 1 160px;max-width:240px;padding:8px 10px;background:#111a25;border:1px solid rgba(255,255,255,.18);border-radius:10px;color:#e8f1ff}

/* Panel Listado (derecha) */
.panel{
  position:absolute;
  z-index:520;background:rgba(15,22,32,.95);
  border:1px solid var(--border);border-radius:var(--radius);
  box-shadow:var(--shadow);display:flex;flex-direction:column;overflow:hidden
}
.panel.right{
  right:28px; top:110px; bottom:98px; width:420px;
}
.panel.hidden{display:none;}
.panel-head,.panel-foot{padding:10px 12px;background:#0f1a28;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
.panel-foot{border-top:1px solid var(--border);border-bottom:none;margin-top:auto}
.pager{display:flex;align-items:center;gap:8px}
.pager .sm{padding:6px 10px;border-radius:10px}
.table-wrap{overflow:auto;height:100%;background:#0e1723}
#grid{width:100%;border-collapse:collapse;font-size:13px}
#grid thead{position:sticky;top:0;background:#132237}
#grid th,#grid td{padding:10px 8px;border-bottom:1px solid rgba(255,255,255,.08)}
#grid tbody tr:hover{background:rgba(59,130,246,.12)}
#grid tbody tr.selected{background:rgba(34,211,238,.12)}

/* HUD inferior (KPI) - Estilo Mapbox */
.hud{
  position:absolute;
  left:50%;
  transform:translateX(-50%);
  bottom:16px;
  display:flex;
  gap:8px;
  z-index:600;
  pointer-events:none;
}
.chip{
  background:rgba(255, 255, 255, 0.98);
  color:#333;
  border:none;
  padding:8px 14px;
  border-radius:20px;
  box-shadow:0 0 0 2px rgba(0,0,0,.1), 0 4px 12px rgba(0,0,0,.15);
  font-size:12.5px;
  font-weight:500;
  display:flex;
  align-items:center;
  gap:6px;
  backdrop-filter:blur(4px);
  transition:all 0.2s ease;
  pointer-events:auto;
}
.chip:hover{
  box-shadow:0 0 0 2px rgba(0,0,0,.15), 0 6px 16px rgba(0,0,0,.2);
  transform:translateY(-1px);
}
.chip svg{
  flex-shrink:0;
  opacity:0.7;
}

/* Transform Panel (izquierda, simétrica con la tabla; tipografía reducida) */
.transform-panel{
  position:absolute;
  left:60px; top:110px; bottom:98px; width:460px;     /* simetría en top/bottom */
  max-width:46vw; max-height:none; overflow:auto;
  background:rgba(15,22,32,.96); border:1px solid var(--border);
  border-radius:14px; box-shadow:var(--shadow); z-index:540; color:#e8f1ff;
  backdrop-filter:blur(6px); font-size:12.5px;
}
.transform-panel .tp-head{display:flex;justify-content:space-between;align-items:center;padding:8px 10px;background:#0f1a28;border-bottom:1px solid var(--border)}
.tp-actions{display:flex;gap:6px}
.tp-body{padding:10px}
.tp-row{margin-bottom:8px}
.tp-row label{display:block;font-size:12px;color:var(--text-muted);margin-bottom:6px}
.tp-grid{display:grid;gap:8px}
.tp-grid.tp-2{grid-template-columns:1fr 1fr}
.tp-grid.tp-6{grid-template-columns:repeat(3,minmax(0,1fr))} /* 3 columnas */
.tp-grid.tp-utm{grid-template-columns:84px 68px 1fr 1fr}
.transform-panel input,.transform-panel select{
  background:#111a25;border:1px solid rgba(255,255,255,.18);color:#e8f1ff;
  border-radius:10px;padding:6px 8px;outline:none;min-width:0;font-size:12.5px
}
.tp-hint small{color:#b9c4d1}

/* Leaflet placements & Mapbox style */
.leaflet-top.leaflet-left{top:88px!important}
.leaflet-control-layers,.leaflet-control-zoom{z-index:5000}

/* Controles de Leaflet estilo Mapbox */
.leaflet-control-zoom{
  border:none!important;
  box-shadow:0 0 0 2px rgba(0,0,0,.1), 0 4px 12px rgba(0,0,0,.15)!important;
  border-radius:8px!important;
  overflow:hidden;
}
.leaflet-control-zoom a{
  background:rgba(255,255,255,0.98)!important;
  color:#333!important;
  border:none!important;
  font-size:18px!important;
  font-weight:600!important;
  width:32px!important;
  height:32px!important;
  line-height:32px!important;
  transition:all 0.15s ease!important;
}
.leaflet-control-zoom a:hover{
  background:rgba(255,255,255,1)!important;
  color:#000!important;
}
.leaflet-control-zoom a:first-child{
  border-bottom:1px solid rgba(0,0,0,.1)!important;
}

/* Responsive */
@media (max-width:1200px){
  .transform-panel{left:16px; right:auto; width:44vw}
  .panel.right{right:16px}
}
@media (max-width:900px){
  /* En pantallas chicas dejamos paneles apilados, pero siguen alineando fondo */
  .transform-panel{top:auto; width:92vw; left:50%; transform:translateX(-50%); bottom:98px}
  .panel.right{width:92vw; right:4vw; left:4vw}
}


/* --- Basemap switcher (estilo Mapbox) --- */
#basemap-switcher{
  position:absolute;
  bottom:16px;
  left:60px;
  z-index:500;
  border:none;
  border-radius:8px;
  padding:10px 12px;
  background:rgba(255, 255, 255, 0.98);
  box-shadow:0 0 0 2px rgba(0,0,0,.1), 0 4px 12px rgba(0,0,0,.15);
  backdrop-filter:blur(4px);
  min-width:200px;
}
#basemap-switcher .panel-title{
  font-weight:600;
  margin:0 0 8px 0;
  color:#333;
  font-size:12.5px;
  text-transform:uppercase;
  letter-spacing:0.5px;
}
#basemap-switcher .switcher-group{
  display:flex;
  flex-direction:column;
  gap:6px;
  align-items:stretch;
}
#basemap-switcher label{
  display:flex;
  align-items:center;
  gap:8px;
  color:#333;
  font-size:13px;
  padding:6px 8px;
  border:1px solid transparent;
  border-radius:6px;
  background:transparent;
  cursor:pointer;
  transition:all 0.15s ease;
  font-weight:500;
}
#basemap-switcher label:hover{
  background:rgba(0, 0, 0, 0.05);
}
#basemap-switcher label.overlay{
  border-top:1px solid rgba(0,0,0,.1);
  margin-top:4px;
  padding-top:10px;
}
#basemap-switcher input[type=radio],
#basemap-switcher input[type=checkbox]{
  accent-color:#4a90e2;
  cursor:pointer;
}


/* --- Medidor de distancia estilo Mapbox --- */
.leaflet-top.leaflet-left .measure-ctrl{
  margin-top:8px;
  border:none!important;
  box-shadow:0 0 0 2px rgba(0,0,0,.1), 0 4px 12px rgba(0,0,0,.15)!important;
  border-radius:8px!important;
  overflow:hidden;
}
.measure-ctrl a{
  width:32px!important;
  height:32px!important;
  display:flex!important;
  align-items:center!important;
  justify-content:center!important;
  font-size:16px;
  background:rgba(255,255,255,0.98)!important;
  color:#333!important;
  border:none!important;
  transition:all 0.15s ease!important;
}
.measure-ctrl a:hover{
  background:rgba(255,255,255,1)!important;
  color:#000!important;
}
.measure-ctrl.is-on a{
  background:#4a90e2!important;
  color:#fff!important;
}
.measure-tip{
  background:rgba(255,255,255,0.98)!important;
  color:#333!important;
  border:none!important;
  box-shadow:0 0 0 2px rgba(0,0,0,.1), 0 4px 8px rgba(0,0,0,.15)!important;
  border-radius:6px!important;
  padding:6px 10px!important;
  font-size:12px!important;
  font-weight:500!important;
}

/* SVG icon size for measure button */
.measure-ctrl a svg{ width:16px; height:16px; }

/* Pin fijo: cruz roja */
.cross-pin { filter: drop-shadow(0 0 2px rgba(0,0,0,.6)); }
.cross-pin svg { display:block; }


