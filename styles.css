:root{
  --bg:#0f1318; --bg-soft:#151b23; --panel:#111821; --card:#141d27;
  --surface:#f7fafc; --text:#f2f6fc; --text-muted:#b9c4d1; --ink:#1f2937;
  --primary:#3b82f6; --primary-2:#2563eb; --accent:#22d3ee; --danger:#ff6b6b; --ok:#34d399;
  --border:rgba(255,255,255,.15); --shadow:0 10px 28px rgba(0,0,0,.35); --radius:16px;
}
*{box-sizing:border-box} html,body{height:100%}
body{margin:0;background:linear-gradient(180deg,#10151b 0%, #0e1620 100%);color:var(--text);font:14px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Arial}

/* Top nav */
.nav{height:58px;display:flex;align-items:center;justify-content:space-between;padding:0 16px;background:rgba(255,255,255,.06);border-bottom:1px solid var(--border);backdrop-filter:blur(8px)}
.brand{display:flex;align-items:center;gap:10px;font-weight:600}
.brand .dot{width:10px;height:10px;border-radius:50%;background:var(--accent);box-shadow:0 0 12px var(--accent)}
.nav-logo{height:56px;max-width:720px;object-fit:contain; background:#0f1a28; border:1px solid var(--border); border-radius:10px; padding:6px 12px;filter:drop-shadow(0 2px 4px rgba(0,0,0,.25))}
.searchbar{display:flex;gap:8px;align-items:center}
.searchbar input{width:220px;padding:10px 12px;border-radius:12px;border:1px solid var(--border);background:#0f1620;color:#fff;outline:none}
.btn{border:none;padding:10px 14px;border-radius:12px;cursor:pointer;color:#fff}
.btn.primary{background:linear-gradient(135deg,var(--primary),var(--primary-2))}
.btn.ghost{background:transparent;border:1px solid var(--border);color:#e6eefb}
.btn.sm{padding:6px 10px;border-radius:10px;background:#112031}

/* Nuevos estilos para el botón de limpiar calculadora */
#tp-btn-clear-calculator {
  background: rgba(255,255,255,0.05);
  border-color: rgba(255,255,255,0.2);
  color: var(--text-muted);
  transition: background 0.3s, color 0.3s;
}

#tp-btn-clear-calculator:hover {
  background: rgba(255,0,0,0.1);
  color: var(--danger);
}

/* Resto del CSS original... */
.stage{position:relative;height:calc(100vh - 58px);width:100%}
#map{
  position:absolute;
  top:12px; left:12px; bottom:86px; right:12px;
  border-radius:18px;border:1px solid rgba(255,255,255,.18);box-shadow:var(--shadow);overflow:hidden
}

/* Filtros */
.pill.filters{position:absolute;top:24px;left:60px;right:28px;display:flex;flex-wrap:wrap;gap:8px 10px;background:rgba(255,255,255,.10);border:1px solid var(--border);border-radius:14px;padding:8px;box-shadow:var(--shadow);z-index:9999}
.pill.filters select{flex:1 1 160px;max-width:240px;padding:8px 10px;background:#111a25;border:1px solid rgba(255,255,255,.18);border-radius:10px;color:#e8f1ff}

/* Panel Listado (derecha) */
.panel{
  position:absolute;
  z-index:520;background:rgba(15,22,32,.95);
  border:1px solid var(--border);border-radius:var(--radius);
  box-shadow:var(--shadow);display:flex;flex-direction:column;overflow:hidden
}
.panel.right{
  right:28px; top:110px; bottom:98px; width:420px;
}
.panel.hidden{display:none;}
.panel-head,.panel-foot{padding:10px 12px;background:#0f1a28;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
.panel-foot{border-top:1px solid var(--border);border-bottom:none;margin-top:auto}
.pager{display:flex;align-items:center;gap:8px}
.pager .sm{padding:6px 10px;border-radius:10px}
.table-wrap{overflow:auto;height:100%;background:#0e1723}
#grid{width:100%;border-collapse:collapse;font-size:13px}
#grid thead{position:sticky;top:0;background:#132237}
#grid th,#grid td{padding:10px 8px;border-bottom:1px solid rgba(255,255,255,.08)}
#grid tbody tr:hover{background:rgba(59,130,246,.12)}
#grid tbody tr.selected{background:rgba(34,211,238,.12)}

/* HUD inferior */
.hud{position:absolute;left:50%;transform:translateX(-50%);bottom:24px;display:flex;gap:10px;z-index:540}
.chip{background:var(--surface);color:var(--ink);border:1px solid rgba(0,0,0,.08);padding:9px 12px;border-radius:14px;box-shadow:0 8px 18px rgba(0,0,0,.2)}

/* Transform Panel (izquierda, simétrica con la tabla; tipografía reducida) */
.transform-panel{
  position:absolute;
  left:60px; top:110px; bottom:98px; width:460px;     /* simetría en top/bottom */
  max-width:46vw; max-height:none; overflow:auto;
  background:rgba(15,22,32,.96); border:1px solid var(--border);
  border-radius:14px; box-shadow:var(--shadow); z-index:540; color:#e8f1ff;
  backdrop-filter:blur(6px); font-size:12.5px;
}
.transform-panel .tp-head{display:flex;justify-content:space-between;align-items:center;padding:8px 10px;background:#0f1a28;border-bottom:1px solid var(--border)}
.tp-actions{display:flex;gap:6px}
.tp-body{padding:10px}
.tp-row{margin-bottom:8px}
.tp-row label{display:block;font-size:12px;color:var(--text-muted);margin-bottom:6px}
.tp-grid{display:grid;gap:8px}
.tp-grid.tp-2{grid-template-columns:1fr 1fr}
.tp-grid.tp-6{grid-template-columns:repeat(3,minmax(0,1fr))} /* 3 columnas */
.tp-grid.tp-utm{grid-template-columns:84px 68px 1fr 1fr}
.transform-panel input,.transform-panel select{
  background:#111a25;border:1px solid rgba(255,255,255,.18);color:#e8f1ff;
  border-radius:10px;padding:6px 8px;outline:none;min-width:0;font-size:12.5px
}
.tp-hint small{color:#b9c4d1}

/* Leaflet placements */
.leaflet-top.leaflet-left{top:88px!important}
.leaflet-control-layers,.leaflet-control-zoom{z-index:5000}

/* Medidor de distancia */
.leaflet-top.leaflet-left .measure-ctrl{ margin-top: 46px; }
.measure-ctrl a{ width:28px;height:28px;display:flex;align-items:center;justify-content:center;font-size:16px; }
.measure-ctrl.is-on a{ background:#0f1a28; color:#fff; }
.measure-tip{ background:#0f1a28;color:#fff;border:1px solid var(--border);border-radius:8px; }

/* SVG icon size for measure button */
.measure-ctrl a svg{ width:16px; height:16px; }

/* Pin fijo: cruz roja */
.cross-pin { filter: drop-shadow(0 0 2px rgba(0,0,0,.6)); }
.cross-pin svg { display:block; }

/* Basemap Switcher */
#basemap-switcher{
  position:relative;
  z-index:400;
  margin-top:12px;
  border:1px solid var(--border);
  border-radius:14px;
  padding:10px 12px;
  background:var(--panel);
  box-shadow:var(--shadow)
}

#basemap-switcher .switcher-group{
  display:flex;
  flex-wrap:wrap;
  gap:10px 14px;
  align-items:center
}

#basemap-switcher label{
  display:flex;
  align-items:center;
  gap:8px;
  color:var(--text);
  font-size:13px;
  padding:6px 10px;
  border:1px solid var(--border);
  border-radius:999px;
  background:rgba(255,255,255,0.04)
}

#basemap-switcher input[type=radio], 
#basemap-switcher input[type=checkbox]{
  transform:scale(1.05)
}

#basemap-switcher label:hover{
  background:rgba(255,255,255,0.07)
}

/* Responsive Design */
@media (max-width:1200px){
  .transform-panel{left:16px; right:auto; width:44vw}
  .panel.right{right:16px}
}

@media (max-width:900px){
  .transform-panel{top:auto; width:92vw; left:50%; transform:translateX(-50%); bottom:98px}
  .panel.right{width:92vw; right:4vw; left:4vw}
}
